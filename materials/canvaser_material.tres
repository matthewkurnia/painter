[gd_resource type="ShaderMaterial" load_steps=4 format=2]

[ext_resource path="res://assets/2d/image-from-rawpixel-id-6968861-original.png" type="Texture" id=1]
[ext_resource path="res://assets/2d/leinwand-orange-textur-hintergrund.png" type="Texture" id=2]

[sub_resource type="Shader" id=5]
code = "shader_type canvas_item;

uniform sampler2D brush_texture;
uniform sampler2D canvas;
uniform float canvas_roughness;

float grainify(float x, float a) {
	x -= 0.5;
	a -= 0.5;
	return max(min(canvas_roughness * (x + a) + 0.5, 1.0), 0.0);
}

void fragment() {
	COLOR.rgb = mix(
		textureLod(SCREEN_TEXTURE, SCREEN_UV, 5.0).rgb,
		COLOR.rgb, 0.7
//		grainify(texture(canvas, SCREEN_UV).x, 0.5)
	);
//	COLOR.r = COLOR.r;
//	COLOR.a = texture(brush_texture, UV).a;
	COLOR.a = COLOR.a * texture(brush_texture, UV).a;
	COLOR.a = grainify(
		texture(canvas, SCREEN_UV).x,
		COLOR.a
	);
//	COLOR.a = texture(canvas, SCREEN_UV).r;
}
"

[resource]
shader = SubResource( 5 )
shader_param/canvas_roughness = 4.0
shader_param/brush_texture = ExtResource( 1 )
shader_param/canvas = ExtResource( 2 )
